# PostgreSQL

## üß® DATATYPE

A common data type is `VARCHAR`. It's a short string of characters. You need to give it a maximum length when using it like this: `VARCHAR(30)`.

```SQL
ALTER TABLE table_name ADD COLUMN column_name VARCHAR(30);
```

You can see the `VARCHAR` type there. The 30 means the data in it can a max of 30 characters.

The `SERIAL` type will make your column an INT with a `NOT NULL` constraint, and automatically increment the integer when a new row is added. View the details of the characters table to see what `SERIAL` did for you.

```sql
ALTER TABLE table_name ADD COLUMN column_name SERIAL;
```

## üí™ **CONSTRAINT**

### Syntax

```sql

-- Example with create table --
CREATE TABLE users (
   id   INT PRIMARY KEY,
   username VARCHAR(33) UNIQUE NOT NULL,
   profile  INT REFERENCES profiles(profile_id)
   age CHECK(age >= 18)
   status VARCHAR(55) DEFAULT 'Active'
);

-- With desire constraint name --

ALTER TABLE <table_name> add CONSTRAINT <constraint_name> CONSTRAINT;

ALTER TABLE  users add CONSTRAINT valid_age CHECK(age >= 18);
ALTER TABLE  articles add CONSTRAINT article_primary_key PRIMARY KEY(article_id, article_author);

-- Rename constraint name --

ALTER TABLE <table_name> RENAME CONSTRAINT <old_constraint_name> TO <new_constraint_name>;

ALTER TABLE articles RENAME CONSTRAINT author_title to compkey_author_title;

-- drop --
ALTER TABLE <table_name> DROP CONSTRAINT <CONSTRAINT_NAME>;

ALTER TABLE users DROP CONSTRAINT users_age_check;
```

### `CHECK()`

A combination of a NOT NULL and UNIQUE constraint, used to identify each row in a table.

```sql
-- syntax --
ALTER TABLE <table_name> ADD COLUMN <column_name> <DATA_TYPE> <CONSTRAINT> CHECK( <column_name> <condition>) ;

-- example --
ALTER TABLE users ADD COLUMN age INT NOT NULL CHECK( age >= 18 );

ALTER TABLE  users add CONSTRAINT valid_age CHECK(age >= 18)

...CHECK (status IN ('Active', 'Inactive'))
...CHECK (grade >= 0 AND grade <= 100),
...CHECK (date_of_birth < NOW()),

-- drop --
ALTER TABLE <table_name> DROP CONSTRAINT <CONSTRAINT_NAME>;

ALTER TABLE users DROP CONSTRAINT users_age_check;
```

### `NOT NULL`

Ensures that a column cannot contain a null value.

```sql
-- syntax --
ALTER TABLE <table_name> ADD COLUMN <column_name> <DATA_TYPE> NOT NULL;

-- examples --
ALTER TABLE users ADD COLUMN username VARCHAR(33) NOT NULL;

ALTER TABLE users ALTER COLUMN username SET NOT NULL;

-- drop --
ALTER TABLE <table_name> ALTER COLUMN <column_name> DROP NOT NULL ;

ALTER TABLE users ALTER COLUMN username DROP NOT NULL ;
```

### `UNIQUE`

Ensures that the values in a column or set of columns are unique across all rows in the table.

```sql
-- syntax --
ALTER TABLE <table_name> ADD COLUMN <column_name> <DATA_TYPE> UNIQUE ;

ALTER TABLE <table_name> ADD UNIQUE(<column_name>) ;

-- examples --
ALTER TABLE users ADD COLUMN username VARCHAR(33) UNIQUE ;

ALTER TABLE users ADD UNIQUE(username) ;

-- drop --
ALTER TABLE <table_name> DROP CONSTRAINT <CONSTRAINT_NAME>;

ALTER TABLE users DROP CONSTRAINT users_username_key;
```

Add the `UNIQUE` constraint to the column you just added.

### `PRIMARY KEY()`

A combination of a NOT NULL and UNIQUE constraint, used to identify each row in a table.

```sql
-- syntax --
ALTER TABLE <table_name> ADD PRIMARY KEY(<column_name>);

-- examples --
ALTER TABLE users ADD PRIMARY KEY(username) ;

-- drop --
ALTER TABLE <table_name> DROP CONSTRAINT <CONSTRAINT_NAME>;

ALTER TABLE users DROP CONSTRAINT users_pkey;
```

**Composite `PRIMARY KEY()`**

A composite primary key, also known as a compound primary key, is a primary key that consists of two or more columns. It is used to uniquely identify each row in a table when the primary key cannot be determined by a single column.

```sql
-- syntax --
ALTER TABLE <table_name> ADD PRIMARY KEY(<column_name>,<column_name>,...) ;

-- examples --
ALTER TABLE articles ADD PRIMARY KEY(title, author) ;

ALTER TABLE articles ADD CONSTRAINT compkey_title_author PRIMARY KEY(title, author)

-- drop --
ALTER TABLE <table_name> DROP CONSTRAINT <CONSTRAINT_NAME>;

ALTER TABLE users DROP CONSTRAINT users_pkey;
```

### `FOREIGN KEY()`

Ensures that the values in a column (or set of columns) match the values in a column (or set of columns) in another table.

```sql
-- syntax --
ALTER TABLE <table_name> ADD COLUMN <column_name> FOREIGN KEY (<column_name>) REFERENCES <table_name>(<column_name>)

ALTER TABLE <table_name> ADD FOREIGN KEY (<column_name>) REFERENCES <table_name>(<column_name>)

-- examples --
ALTER TABLE profiles ADD COLUMN user_id int REFERENCES users(user_id)

ALTER TABLE profiles ADD FOREIGN KEY(stat_id) REFERENCES statistics(stat_id)

-- drop --
ALTER TABLE <table_name> DROP CONSTRAINT <CONSTRAINT_NAME>;

ALTER TABLE users DROP CONSTRAINT profile_uname_fkey;
```

### `DEFAULT`

is a constraint that specifies a default value for a column. If no value is specified for the column when a new row is inserted, the default value will be used.

```sql
-- syntax --
ALTER TABLE <table_name> ALTER COLUMN <column_name> SET DEFAULT <value> ;

-- examples --
ALTER TABLE users ALTER COLUMN name SET DEFAULT 'Anonymous' ;

-- drop --

ALTER TABLE profiles ALTER COLUMN name DROP DEFAULT;
```

### `EXCLUDE`

_not yet learn_

### `DEFERRABLE`

_not yet learn_

### `INITIALLY DEFERRED`

_not yet learn_

## üöÄ DATABASE

```sql
-- First thing to do is see what databases are here. Type `\l` into the prompt to list them.

\l

-- You can connect to a database by entering `\c database_name`.

\c database_name

-- You can make your own like this

CREATE DATABASE database_name;

--- You can rename a database like this

ALTER DATABASE database_name RENAME TO new_database_name;

ALTER DATABASE persons RENAME TO characters;
```

```sql
-- You can drop a database like this

DROP DATABASE database_name;
```

## üè≠ DATA DEFINITION

```sql
-- A database is made of tables that hold your data. Enter `\d` to display the tables.

\d

-- You can create a table like this

CREATE TABLE table_name();

-- You can create table and same time add column into the table.

CREATE TABLE table_name(column_name DATATYPE CONSTRAINT);

CREATE TABLE planet(planet_name VARCHAR(30) UNIQUE PRIMARY KEY);

--- You can view more details about a table by adding the table name after the display command like this: `\d table_name`.

\d table_name
```

```sql
--- You ables need columns to describe the data in them. Here's an example of how to add one.

ALTER TABLE table_name ADD COLUMN column_name DATATYPE CONSTRAINT;

ALTER TABLE planet ADD COLUMN planet_name VARCHAR(30) UNIQUE;

-- You will probably need to know how to remove them. Here's an example:

ALTER TABLE table_name DROP COLUMN column_name;

ALTER TABLE planet DROP COLUMN planet_name;

-- You named that column name, it should have been different. Here's how you can rename a column.

ALTER TABLE table_name RENAME COLUMN column_name TO new_name;

ALTER TABLE persons RENAME COLUMN name TO username;

```

```sql
-- Something always comes up. You might need to delete your table. Here's an example

DROP TABLE table_name;

DROP TABLE persons;
```

### Primary Key

```sql
-- Next, you are going to add a primary key. It's a column that uniquely identifies each row in the table. Here's an example of how to set a PRIMARY KEY:

ALTER TABLE table_name ADD PRIMARY KEY(column_name);

ALTER TABLE persons ADD PRIMARY KEY(nid);

-- Here's an example of how to drop a constraint:
ALTER TABLE table_name DROP CONSTRAINT constraint_name;

ALTER TABLE characters DROP CONSTRAINT characters_pkey;

-- To know what row a character is for, you need to set a foreign key so you can relate rows from this table to rows from your characters table. Here's an example that creates a column as a foreign key:

ALTER TABLE table_name ADD COLUMN column_name DATATYPE REFERENCES referenced_table_name(referenced_column_name);

ALTER TABLE additional_info ADD COLUMN character_id DATATYPE REFERENCES characters(character_id);

-- You can set an existing column as a foreign key like this:

ALTER TABLE table_name ADD FOREIGN KEY(column_name) REFERENCES referenced_table(referenced_column);

ALTER TABLE additional_info ADD FOREIGN KEY(character_id) REFERENCES characters(character_id);
```

### Relationships

```sql
-- These tables have a "one-to-one" relationship. One row in the characters table will be related to exactly one row in more_info and vice versa. Enforce that by adding the UNIQUE constraint to your foreign key.

ALTER TABLE table_name ADD UNIQUE(column_name);

---

ALTER TABLE table_name ADD COLUMN column_name DATATYPE CONSTRAIN REFERENCES referenced_table_name(referenced_column_name);

ALTER TABLE additional_info ADD COLUMN character_id VARCHAR(30) UNIQUE REFERENCES characters(character_id);

```

```sql
-- This will be a "one-to-many" relationship because one character will have many sounds, but no sound will have more than one character. Here's the example again:

ALTER TABLE table_name ADD COLUMN column_name DATATYPE CONSTRAINT REFERENCES referenced_table_name(referenced_column_name);
```

```sql
-- "Many-to-many" relationships usually use a junction table to link two tables together, forming two "one-to-many" relationships.

```

## üíæ DATA MANIPULATION

### Inserting Data

```sql
-- Rows are the actual data in the table. You can add one like this

INSERT INTO table_name(column_1, column_2) VALUES(value1, value2);

INSERT INTO persons(id,username) VALUES(1,'Sizar');

-- Update Multiple row/data at the same time

INSERT into persons(name,homeland,favorite_color) values('Toadstool','Mushroom Kingdom','Red'),('Bowser','Mushroom Kingdom','Green');

```

### Updating Data

```sql
--- You can change a value like this:
UPDATE table_name SET column_name=new_value WHERE CONDITIONS;

UPDATE characters SET favorite_color='Orange' WHERE name='Daisy';

```

### Deleting Data

```sql
-- Here's an example of how to delete a row.

DELETE FROM table_name WHERE CONDITIONS;

DELETE FROM persons WHERE username='Sizar';
```

## üíª QUERIES

```sql
-- You can view the data in a table by querying it with the `SELECT` statement. Here's how it looks:

SELECT columns FROM table_name;

-- Use an asterisk `*` to denote that you want to see all the columns.

SELECT * FROM table_name;
```

### Projecting Data / Rearranging

```sql
-- Actually, you should put that in order. Here's an example:

SELECT columns FROM table_name ORDER BY column_name;

SELECT * FROM persons ORDER BY country;
```

## üíë JOIN
